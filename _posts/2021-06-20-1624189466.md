---
title: maven配置私服——setting.xml中profile无效
categories: 依赖管理——maven
tags: maven私服 setting.xml prifile 无效
---
# 背景

例如公司搭建了自己的maven私服，此时我们需要从私服获取依赖，那么在maven中如何使用指定的私服呢？

# 方法尝试

在百度了很多文章后，选择了一种说得比较多的方案，配置maven的profile：  
在maven的setting.xml中增加如下配置：

    
    
    <profiles>
     <profile>
        <id>nexus</id>
        <repositories>
            <repository>
                <id>central</id>
                <name>Nexus</name>
                <url>maven私服地址</url>
                <releases>
                    <enabled>true</enabled>
                </releases>
                <snapshots>
                    <enabled>true</enabled>
                </snapshots>
            </repository>
        </repositories>
        <pluginRepositories>
            <pluginRepository>
                <id>central</id>
                <name>Nexus</name>
                <url>maven私服地址</url>
                <releases>
                    <enabled>true</enabled>
                </releases>
                <snapshots>
                    <enabled>true</enabled>
                </snapshots>
            </pluginRepository>
        </pluginRepositories>
     </profile>
    <profiles>
    
        <activeProfiles>
            <activeProfile>nexus</activeProfile>
      </activeProfiles>
    

进行尝试过后，发现没用！

# 问题分析

于是我将maven
本地仓库中的目录删除，让maven重新引入依赖，并观察引入过程，发现maven并没有从私服地址引入，而是从阿里镜像http://maven.aliyun.com/nexus/content/groups/public/中引入依赖！

之前为了加快jar包引入，为maven配置了阿里maven镜像：

    
    
    <mirror>
      <id>alimaven</id>
      <name>aliyun maven</name>
      <url>http://maven.aliyun.com/nexus/content/groups/public/</url>
      <mirrorOf>central</mirrorOf>        
    </mirror>
    

难道是阿里镜像覆盖了私服？于是我将ali镜像注释掉：

    
    
    <!--
    <mirror>
      <id>alimaven</id>
      <name>aliyun maven</name>
      <url>http://maven.aliyun.com/nexus/content/groups/public/</url>
      <mirrorOf>central</mirrorOf>        
    </mirror>
    -->
    

再次引入，观察到所有依赖均从私服引入，成功！

# 总结

在配置并启动了私服profile之前，一定不要忘了删除之前配置的仓库镜像，否则私服会被覆盖掉，不起作用。

