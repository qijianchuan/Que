---
title: 【FastDFS】FastDFS安装手册（单机版）
categories: FastDFS相关教程
tags: 
---
一、前言

FastDFS是用c语言编写的一款开源的分布式文件系统。FastDFS为互联网量身定制，充分考虑了冗余备份、负载均衡、线性扩容等机制，并注重高可用，高性能等指标。使用FastDFS很容易搭建一套高性能的文件服务器集群提供文件上传、下载等服务。具体有关FastDFS的知识点，欢迎猛戳我的博客。

二、基本环境说明

跟踪服务器（Tracker Server）： 192.168.224.200

存储服务器（Storage Server）：192..168.224.201

操作系统：CentOS7

安装包：

libfastcommon-master.zip：公共C函数库

fastdfs-master-V5.05.zip：FastDFS源码  

fastdfs-nginx-module-master.zip：FastDFS的nginx模块

nginx-1.10.0.tar.gz：Nginx安装包

将文件下载到/usr/local/src目录下面。

三、安装基本环境

在tracker和storage服务器上执行相同的操作。

1、安装所需的依赖包

    
    
    yum install make cmake gcc gcc-c++

2、安装libfastcommon

    
    
    cd /usr/local/src
    unzip libfastcommon-master.zip
    cd libfastcommon-master
    ## 编译、安装
    ./make.sh
    ./make.sh install
    

3、安装FastDFS

    
    
    cd /usr/local/src
    unzip fastdfs-master-V5.05.zip
    cd fastdfs-master
    ## 编译、安装
    ./make.sh
    ./make.sh install

四、配置tracker服务器

1、复制tracker配置文件，重命名

    
    
    cp /etc/fdfs/tracker.conf.sample /etc/fdfs/tracker.conf

2、修改tracker.conf配置文件

    
    
    vim /etc/fdfs/tracker.conf
    # 修改的内容如下：
    disabled=false              # 启用配置文件
    port=22122                  # tracker服务器端口（默认22122）
    base_path=/fastdfs/tracker  # 存储日志和数据的根目录
    

3、创建base_path指定的目录

    
    
    mkdir -p /fastdfs/tracker

4、在防火墙中打开tracker服务器的端口

由于操作系统选用的是CnetOS7。默认的防火墙为firewall。相关命令如下

查看当前防火墙状态：

    
    
    firewall-cmd --state

开启状态\---running

关闭状态\---not runing

将某个端口（在此以22122为例）开放

    
    
    firewall-cmd --zone=public --add-port=22122/tcp --permanent

重启防火墙

    
    
    service firewalld restart 

查看开放端口列表：

    
    
    firewall-cmd --permanent --list-port

5、启动tracker服务器

    
    
    /etc/init.d/fdfs_trackerd start

初次启动，会在/fastdfs/tracker目录下生成logs、data两个目录：

![](data:image/png;base64,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)  

检查tracker server是否成功启动

    
    
    ps -ef | grep fdfs_trackerd 

6、设置tracker开机自启

    
    
    chkconfig fdfs_trackerd on

五、配置storage服务器

1、复制storage配置文件

    
    
    cp /etc/fdfs/storage.conf.sample /etc/fdfs/storage.conf

2、编辑配置文件

    
    
    vi /etc/fdfs/storage.conf
    # 修改的内容如下:
    disabled=false                      # 启用配置文件
    port=23000                          # storage服务端口
    group_name=group1                   # 组名（第一组为group1，第二组为group2，依次类推...）
    base_path=/fastdfs/storage          # 数据和日志文件存储根目录
    store_path0=/fastdfs/storage        # 第一个存储目录，第二个存储目录起名为：store_path1=xxx，其它存储目录名依次类推...
    store_path_count=1                  # 存储路径个数，需要和store_path个数匹配
    tracker_server=192.168.224.200:22122  # tracker服务器IP和端口
    http.server_port=8888               # http访问文件的端口
    

3、创建基础数据目录

    
    
    mkdir -p /fastdfs/storage

4、防火墙中打开storage服务器端口

具体操作步骤参考 防火墙打开tracker服务器端口

5、启动storage端口

    
    
    /etc/init.d/fdfs_storaged start

6、初次启动，会在/fastdfs/storage目录下生成logs、data两个目录。

7、检查FastDFS Tracker Server是否启动成功

    
    
    ps -ef | grep fdfs_storaged 

8、设置storage服务开机启动

    
    
    chkconfig fdfs_storaged on

六、使用Client文件文件上传

1、复制 **tracker** 服务器client.conf并重命名

    
    
    cp /etc/fdfs/client.conf.sample /etc/fdfs/client.conf
    vi /etc/fdfs/client.conf
    base_path=/fastdfs/tracker
    tracker_server=192.168.224.200:22122
    

2、执行上传文件命令

    
    
    /usr/bin/fdfs_upload_file /etc/fdfs/client.conf /usr/local/src/fastdfs-master-V5.05.zip

返回文件id：group1/M00/00/00/xxxxxxxxxxxxxxxxxxxxxxx 说明文件上传成功

七、Storage节点安装Nginx和fastdfs-nginx-module模块

fastdfs-nginx-module 可以 **重定向文件连接到源服务器** （192.168.224.201） **上**
取文件，避免客户端由于同步文件延迟导致的文件无法访问错误。

1、安装nginx和fastdfs-nginx-module模块

    
    
    ## 安装nginx所需的依赖包
    yum install gcc gcc-c++ make automake autoconf libtool pcre pcre-devel zlib zlib-devel openssl openssl-devel
    ## 编译安装nginx（添加fastdfs-nginx-module模块）
    cd /usr/local/src	
    tar -zxvf nginx-1.10.0.tar.gz
    unzip fastdfs-nginx-module-master.zip
    cd nginx-1.10.0
    ./configure --prefix=/opt/nginx --sbin-path=/usr/bin/nginx --add-module=/usr/local/src/fastdfs-nginx-module-master/src
    make && make install
    

2、复制fastdfs-nginx-module 源码中的配置文件到/etc/fdfs 目录，并修改。

    
    
    cp /usr/local/src/fastdfs-nginx-module-master/src/mod_fastdfs.conf /etc/fdfs/
    vi /etc/fdfs/mod_fastdfs.conf
    

3、复制fastdfs-nginx-module 源码中的配置文件到/etc/fdfs 目录，并修改

    
    
    cp /usr/local/src/fastdfs-nginx-module-master/src/mod_fastdfs.conf /etc/fdfs/
    vi /etc/fdfs/mod_fastdfs.conf
    

配置如下图所示：

    
    
    connect_timeout=10                  # 客户端访问文件连接超时时长（单位：秒）
    base_path=/tmp                      # 临时目录
    tracker_server=192.168.0.200:22122  # tracker服务IP和端口
    storage_server_port=23000           # storage服务端口
    group_name=group1                   # 组名
    url_have_group_name=true            # 访问链接前缀加上组名
    store_path0=/fastdfs/storage        # 文件存储路径

4、复制FastDFS源文件目录中HTTP相关的配置文件到/etc/fdfs目录

    
    
    cd /usr/local/src/fastdfs-master/conf
    cp http.conf mime.types /etc/fdfs/
    

5、创建数据存放目录的软链接

    
    
    ln -s /fastdfs/storage/data/ /fastdfs/storage/data/M00

6、配置fastdfs-nginx-module

    
    
    vi /opt/nginx/conf/nginx.conf
    user nobody;
    worker_processes 1;
    events {
        worker_connections  1024;
    }
    http {
        include       mime.types;
        default_type  application/octet-stream;
        sendfile        on;
        keepalive_timeout  65;
        server {
            listen       8888;
            server_name  localhost;
    
            # FastDFS 文件访问配置(fastdfs-nginx-module模块)
            location ~/group([0-9])/M00 {
                ngx_fastdfs_module;
            }
    
            error_page 500 502 503 504 /50x.html;
            location = /50x.html {
                root   html;
            }   
        }
    }

注意事项：

8888 端口值要与/etc/fdfs/storage.conf中的http.server_port=8888 相对应，因为
http.server_port 默认为 8888

防火墙中打开nginx的8888端口。方式参考上文。

7、启动nginx

    
    
    /usr/bin/nginx

8、设置nginx开机自启

    
    
    vi /etc/rc.local
    # 加入
    /usr/bin/nginx 
    chmod +x /etc/rc.local  # centos7

注：在这里nginx的作用是：充当http服务器。用来访问静态资源。

9、通过浏览器访问之前上传的文件

    
    
    http://192.168.1.202:8888/group1/M00/00/00/wKgBh1Xtr9-AeTfWAAVFOL7FJU4.tar.gz 

此时就能在浏览器中下载文件啦。  
  
  

  

  

  

  

  

  

