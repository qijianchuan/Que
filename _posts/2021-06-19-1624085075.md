---
title: java生成唯一有序序列号_Java秒杀系统实战系列-分布式唯一ID生成订单编号
categories: 
tags: java生成唯一有序序列号 给一张表加一个自动编号字段
---
![95d2e5e0243c34abdb62799ec6fc73c5.gif](data:image/png;base64,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)

本文是“Java秒杀系统实战系列文章”的第七篇，在本文中我们将重点介绍
“在高并发，如秒杀的业务场景下如何生成全局唯一、趋势递增的订单编号”，我们将介绍两种方法，一种是传统的采用随机数生成的方式，另外一种是采用当前比较流行的“分布式唯一ID生成算法-
雪花算法”来实现。

在上一篇文章，我们完成了商品秒杀业务逻辑的代码实战，在该代码中，我们还实现了“当用户秒杀成功后，需要在数据库表中为其生成一笔秒杀成功的订单记录”的功能，其对应的代码如下所示：

    
    
    //通用的方法-记录用户秒杀成功后生成的订单-并进行异步邮件消息的通知private void commonRecordKillSuccessInfo(ItemKillkill, Integer userId) throws Exception{ //TODO:记录抢购成功后生成的秒杀订单记录 ItemKillSuccess entity=new ItemKillSuccess(); //此处为订单编号的生成逻辑 String orderNo=String.valueOf(snowFlake.nextId()); //entity.setCode(RandomUtil.generateOrderCode()); //传统时间戳+N位随机数 entity.setCode(orderNo);//雪花算法 entity.setItemId(kill.getItemId()); entity.setKillId(kill.getId()); entity.setUserId(userId.toString()); entity.setStatus(SysConstant.OrderStatus.SuccessNotPayed.getCode().byteValue()); entity.setCreateTime(DateTime.now().toDate()); //TODO:学以致用，举一反三 -> 仿照单例模式的双重检验锁写法 if (itemKillSuccessMapper.countByKillUserId(kill.getId(),userId)<= 0){ intres=itemKillSuccessMapper.insertSelective(entity); //其他逻辑省略 }}

在该实现逻辑中，其核心要点在于“在高并发的环境下，如何高效的生成订单编号”，那么如何才算是高效呢？Debug认为应该满足以下两点：

1、保证订单编号的生成逻辑要快、稳定，减少时延；

2、要保证生成的订单编号全局唯一、不重复、趋势递增、有时序性。

下面，我们采用两种方式来生成“订单编号”，并自己写一个多线程的程序模拟生成的订单编号是否满足条件。

值得一提的是，为了能直观的观察多线程并发生成的订单编号是否具有唯一性、趋势递增，在这里Debug借助了一张数据库表
random_code来存储生成的订单编号，其DDL如下所示：

    
    
    CREATE TABLE `random_code` ( `id`int(11) NOT NULL AUTO_INCREMENT, `code`varchar(255) DEFAULT NULL, PRIMARY KEY(`id`), UNIQUE KEY`idx_code` (`code`) USING BTREE) ENGINE=InnoDB DEFAULT CHARSET=utf8;

从该数据库表数据结构定义语句中可以看出，我们设定了 订单编号字段code
为唯一！所以如果高并发多线程生成的订单编号出现重复，那么在插入数据库表的时候必然会出现错误。

下面，首先开始我们的第一种方式吧：基于随机数的方式生成订单编号。

(1)首先是建立一个Thread类，其run方法的执行逻辑为生成订单编号，并将生成的订单编号插入数据库表中，其代码如下所示：

    
    
    /** * 随机数生成的方式-Thread * @Author:debug (SteadyJack) * @Date:2019/7/11 10:30 **/public class CodeGenerateThread implementsRunnable{ private RandomCodeMapper randomCodeMapper;  public CodeGenerateThread(RandomCodeMapper randomCodeMapper) { this.randomCodeMapper = randomCodeMapper; }  @Override public void run() { //生成订单编号并插入数据库 RandomCode entity=new RandomCode(); entity.setCode(RandomUtil.generateOrderCode()); randomCodeMapper.insertSelective(entity); }}

其中，RandomUtil.generateOrderCode()的生成逻辑是借助ThreadLocalRandom来实现的，其完整的源代码如下所示：

    
    
    /** * 随机数生成util * @Author:debug (SteadyJack) * @Date:2019/6/20 21:05 **/public class RandomUtil { private static final SimpleDateFormat dateFormatOne=newSimpleDateFormat("yyyyMMddHHmmssSS"); private static final ThreadLocalRandom random=ThreadLocalRandom.current(); //生成订单编号-方式一 public static String generateOrderCode(){ //TODO:时间戳+N为随机数流水号 return dateFormatOne.format(DateTime.now().toDate()) + generateNumber(4); } //N为随机数流水号 public static String generateNumber(final int num){ StringBuffer sb=new StringBuffer(); for(int i=1;i<=num;i++){ sb.append(random.nextInt(9)); } return sb.toString(); }}

(2)紧接着是在 BaseController控制器
中开发一个请求方法，目的正是用来模拟前端高并发触发产生多线程并生成订单编号的逻辑，在这里我们暂且用1000个线程进行模拟，其源代码如下所示：

    
    
    @Autowiredprivate RandomCodeMapper randomCodeMapper;//测试在高并发下多线程生成订单编号-传统的随机数生成方法@RequestMapping(value ="/code/generate/thread

