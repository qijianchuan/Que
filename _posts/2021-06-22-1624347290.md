---
title: MySQL查询及删除重复记录的方法
categories: Java体系
tags: mysql delete integer table
---
**如果您喜欢这些文章，欢迎点击此处订阅本Blog**

![Blog
订阅](data:image/png;base64,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)  

<script type="text/javascript"> </script> <script
src="http://pagead2.googlesyndication.com/pagead/show_ads.js"
type="text/javascript"></script>

  

**MySQL查询及删除重复记录的方法**

  
(一)  
1、查找表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断  
select * from people  
where peopleId in (select peopleId from people group by peopleId having
count(peopleId) > 1)  
  
2、删除表中多余的重复记录，重复记录是根据单个字段（peopleId）来判断，只留有rowid最小的记录  
delete from people  
where peopleId in (select peopleId from people group by peopleId having
count(peopleId) > 1)  
and rowid not in (select min(rowid) from people group by peopleId having
count(peopleId )>1)  
  
3、查找表中多余的重复记录（多个字段）  
select * from vitae a  
where (a.peopleId,a.seq) in (select peopleId,seq from vitae group by
peopleId,seq having count(*) > 1)  
  
4、删除表中多余的重复记录（多个字段），只留有rowid最小的记录  
delete from vitae a  
where (a.peopleId,a.seq) in (select peopleId,seq from vitae group by
peopleId,seq having count(*) > 1)  
and rowid not in (select min(rowid) from vitae group by peopleId,seq having
count(*)>1)  
  
  
5、查找表中多余的重复记录（多个字段），不包含rowid最小的记录  
select * from vitae a  
where (a.peopleId,a.seq) in (select peopleId,seq from vitae group by
peopleId,seq having count(*) > 1)  
and rowid not in (select min(rowid) from vitae group by peopleId,seq having
count(*)>1)  
  
(二)  
比方说  
在A表中存在一个字段“name”，  
而且不同记录之间的“name”值有可能会相同，  
现在就是需要查询出在该表中的各记录之间，“name”值存在重复的项；  
Select Name,Count(*) From A Group By Name Having Count(*) > 1  
  
如果还查性别也相同大则如下:  
Select Name,sex,Count(*) From A Group By Name,sex Having Count(*) > 1  
  
  
(三)  
 **方法一**  
  
declare @max integer,@id integer  
  
declare cur_rows cursor local for select 主字段,count(*) from 表名 group by 主字段
having count(*) >； 1  
  
open cur_rows  
  
fetch cur_rows into @id,@max  
  
while @@fetch_status=0  
  
begin  
  
select @max = @max -1  
  
set rowcount @max  
  
delete from 表名 where 主字段 = @id  
  
fetch cur_rows into @id,@max  
  
end  
  
close cur_rows  
  
set rowcount 0  
  
 **方法二**  
  
有两个意义上的重复记录，一是完全重复的记录，也即所有字段均重复的记录，二是部分关键字段重复的记录，比如Name字段重复，而其他字段不一定重复或都重复可以忽略。  
  
1、对于第一种重复，比较容易解决，使用  
  
select distinct * from tableName  
  
就可以得到无重复记录的结果集。  
  
如果该表需要删除重复的记录（重复记录保留1条），可以按以下方法删除  
  
select distinct * into #Tmp from tableName  
  
drop table tableName  
  
select * into tableName from #Tmp  
  
drop table #Tmp  
  
发生这种重复的原因是表设计不周产生的，增加唯一索引列即可解决。  
  
2、这类重复问题通常要求保留重复记录中的第一条记录，操作方法如下  
  
假设有重复的字段为Name,Address，要求得到这两个字段唯一的结果集  
  
select identity(int,1,1) as autoID, * into #Tmp from tableName  
  
select min(autoID) as autoID into #Tmp2 from #Tmp group by Name,autoID  
  
select * from #Tmp where autoID in(select autoID from #tmp2)  
  
最后一个select即得到了Name，Address不重复的结果集（但多了一个autoID字段，实际写时可以写在select子句中省去此列）  
  
(四)  
查询重复  
  
select * from tablename where id in (  
  
select id from tablename  
  
group by id  
  
having count(id) > 1  
  
)

  

<script type="text/javascript"> </script> <script
src="http://pagead2.googlesyndication.com/pagead/show_ads.js"
type="text/javascript"></script>

  

<script type="text/javascript"> </script> <script
src="http://pagead2.googlesyndication.com/pagead/show_ads.js"
type="text/javascript"></script>

  

