---
title: Netty5+Websocket
categories: Netty5
tags: netty5 websocket websocket netty5
---
根据官方文档和自己实际操作整理，方便自己以后使用。为了方便，用maven做的例子。

![](data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUoAAAE+CAYAAADrmlnSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAADjZSURBVHhe7Z1rsB5Heef1Jd/5sFVJPqQ2IeC41rVASCDLWWJ2q3ZDkt1KWKqosreyZYdszoYNm4CXDWYxkSywV/FlfRaM5BT4kmxsZILA2FjYAUWyiC8kFBgDRjFrWzcjIelI8k06kiV6+3m6e+bpnu7pmTnvZebM/1fVet/pe885/VPP+56ZXqcmwIXv3szhDz/x5eI98e1tH+LX9Tt3qstu36lu33m72vnserVTv162Xsetv53TQRd+oJYW1qnF7fYQADA1JibK3/7Tu/n1HevNq+Pxz12p3qYluWvXLi3Iy9T629/G4W3rdbisTpTb1eK6dWqdDWkhGGGsW7egln5gozxsPQtLOud82b6o+xEM5AdLC5W+xeKqQJQAzIqJifLuXU/y6+f/7vuFKA889BH1j/e+X4vxdh126rBerb/sbXoleZmWpH6/fj3nq2LkVkqApLCoY2MYYSwsLKiFiClZOj0RpTZl0I+45EmosbH4QJQAzIpaUe7Ul8ybNm2yRx14fjeHZ5/dyatKDnYlSYHio/xgSYuvqdisMJZ0mXWhTClNS2gpFNScoHF5UqT/EBbVohaj/59CanUsgSgBmBVJUe7YsUNddNFF6oILLrAxaa54/yeUOnpfbSAprl9PgtypNmzYkJYkE64o6yiFUVmJuRVcuJJjYdFKzgTTjqlHlvcvgf2PAsp8FG9lXEkLCeRG/dIH3I6L5L5J4afadXX56UXdRHScRK5sg7oBGBFRUTpJXnLJJY1E+Xv/5c+Veu6vGgfOn4MkwhM0dcntEPLhMi5/EF8IT8cvCmnKMmE+V55lJVd5YZrup7NIZdXoI6VIYue3VMa1S31wddW2a9575yccf2qcTcrWpgMwLiqilJK89NJLG4mSOPL129W+O9/Fr8Tl//k2HW4twmX0+vv2lY71e3rNUXzGWMgjpCoPXnXRxJbyKQRoKOr1ZCzEJFd2LAmXtwxmdReTWVqUpRRlvvK9tyqubVeO21GNi48zV7ZZ3QCMBU+UoSTbiJIkqc59x7xqvrjvfDb8h9/5v5w3j1m1xSdpMIGtFJdC4ThR2svRIk0KUeNERYKJlq/QUpScX7cnV5EUy6vLoGxtuxmZ1Y4zUzabDsC48ERJX9yQGGW49tprbWqaI7tuUCt7Nqh3XLiOX4/supHj737yjA4r9lWGFfVv37WV80ShSe3NyFBGknACG6lWLhudcAL5mBWXyMsCW1SLnuyqot6+6Mq0FSWV1XXp8oXECOqXjlv0xFjXrhm3XGl7Y6kdZ6ZsNh2AcZH8MqcNtIqUonSrytseeUHd9rAO+vVW+0rhLe/4HKfXYSYmCc8EKQufUJS2rIzwpGElYOtdIGF5AqhKgrErtGp/2ouS++PVQVjBN27Xjlv336X5IqsbZ7Oy6XQAxsWqRbnvvivV8q7LWZBP3Hoxvy7vvFzt1/Ef335Mffz+o/pVh/v1e/36+t+8x5YE88OKMGm+XDoA42L1otSrx/PPbFTLuz/AK0p6Pf/0Ro6/8NfuqwTQByBKANqwalE+cs3r1I8PbFYn9yyp+29+J7+q/Zs5HvQViBKANqxalM89egdLMQwUDwAAa4GJfJkDAABrGYgSAAAyQJQAAJABogQAgAwQJQAAZIAoAQAgw2BFuXjxG+27gcO3KGZueQQAzJXeivJr17/ZC8TGt/90MswMFtsE73vuIspJ9wEAUEsvRbntva+x70oOfOtBFuLZU3+jDj9ys7rhP/1a8X6WoqQHbnhP/ZkDfegDAGOid6L82jVvViuHb+FAt0MefnyT2rvrSnXi2UdYiCTGJ/56A196u/ezE2X4pKB50Ic+ADAueifKr17zRrVy8rFK+NBv/ysWIq0kSZIu0DHF131m6T+yLXjUmNsXpngMmz22ofLMSC+fFtb28jFofG+0fYRapWzqcWneZbSts27/ncgj49qMIX4uCL+MlxZe6nvHbfvQpW8AzJf+iXK9FuXheyrh3KlnWYjucpvE2OjSO/l5npngMVlU5GQp9rhhAjE4QboMoUxS+9dURBnW4a8e/T6kxiDLOJHR29S5iIw72UdNOLbG57FL3wCYP70T5ZdIlHvv8MK2K17fKMSx8gmE401Sh7daC6hM5HDS546pisiKyas3JhJxXOlDYgxFG2Uw0kqci+i4ayTmHbc4j136BkAP6J0ot11xkVrZs1QEEuDK3ltqA32OmRalw0zociK2mOAalpyfOSNGccxiESssKRpPOmEd1MfyuNqHdmMoCc5FUpSy/xMSZdu+AdADeifKO9/7Gi3ITRxYkvZ9KmQlqSf1UjnDxaSOTHAWlYzbrpaMKRJ55WSuOQ4EYVaWbUUZ60OTMVDzZVvxc2HKVC69XZ+5j2W/vP436oM7j136BsD86Z0ob7vsZ9TK41caST6+oTY0W0nSZDSXeByK2ZeYjCwFl1/IrLISCqVWd2zaKi415f413J6TTlgHlbPH0T40GUMopjK+ukIWaUWfDPJjg+j+O7V9EHV16hsA86V3orzpnT9tJXllbWgqyUlAE7j6xcRs6UMfABgrvRMlcdviLzQKsyFc5c2DPvQBgPHSS1ECAECfgCgBACADRAkAABkgSgAAyABRAgBABogSAAAyQJQAAJABogQAgAyDFWXd8ycHBd/S1/GPyVdTFgDQmN6KEnvm1OD6AFECMBN6KUrsmVNPH/oAwJiYmSh37typNm3aZI/SYM+cHLjvG4BZMxNR7tixQ1100UXqggsusDFpsGeOrrPpnjleWU20DTNOWQ+fD6+OSL8AAAVTF6WT5CWXXNJMlNgzJ6jDXz16fWjahpQr5SueH1lTBgBQMFVRSkleeumljURJHPn67Wrfne/iV4KeO9kkxLHyqVyuSmFYPKEEVIRrV3+lZTLHVEVkZVsRpSxDfRTHYR8qfUq0IettXAYA4JiaKENJthElSVKd+4551cT2yZFhtHvmVOpJtKFxD/6lOvw86TIAAMPURElf3JAYZbj22mttapoju25QK3s2qHdcuI5fj+y6keNj++VQGPWeObJsXRsE5V1YVItyhZorAwBgZvJlThtoFSlFWawqsWdOtQ9e2Zo2GJvumzZTBgBA9EqU++67Ui3vupwF+cStF/Pr8s7L1X4djz1zIn3wRAkAmBb9EqVePZ5/ZqNa3v0BXlHS6/mnN3I89syp9oEvlSsrXQDApOmVKB+55nXqxwc28x+a33/zO/lV7d/M8UBAny3y5TJWkwDMgl6J8rlH72AphoHiAQBgXvTuyxwAAOgbECUAAGSAKAEAIANECQAAGSBKAADIAFECAECG0Yry/W/9SftulphbBiu3TU6NWbcHwNpkFKLcufEX1UP/85974RPv+qeVOMo3XSBKAIbIKET50AcvUj/YeZt67ut/weGbf329uu19l1TiKN90GYooIVgAJIMUZdP9dxw7/8c/Yxmeef4ravnbd6nvP7CFRRnGUb7pAlECMEQGJ8o2++84vvJ+I0oSIkvxwVsKUco4yleH/wQfelCFkIn3bEeTVjy+rCjjBOSnSyGZZ0K6NHkvt1+mep93rM1AePy0IZ1edjpSJmgHD90AYFiibLv/juPL/+1CvrSmVSMJ8dE7NvJmZWEc5auDJeYko8W4sFA+LbyUKIkmfKakk5V570mOH3Bhj5OPTTPyKoWrkeVi6Yxom/PLfuX7WfgUgJEzGFFOav8dWkmSJF2gYxfoC57ab8OFyLYvkmS0bHjFRWKx0mEhiRWZDUZiMQHJOCO8yv4+VGdlZSfKRdMJm2dRStXSup8AjJdBiHKS+++4L25IkuGXOZ//vddynjQkkIggactaJ6qktIiYgNJxhTCToqxLJ2w9tPJtJF9HrE8AjJdBiHLS+++kvsy5+/Kf5/Q66PKbLrndJbg7Li97zapQSma7XtHZ3EZcItF8JmnT9Yo1vr+PqbNy6V2ILmwzsteP/XxS5sn1U6YBMGYG92VOG2gVKUXpVpWpL3Pu/J1Xc3otoXD4OFit2TzucrYUjhUQXwq7dP+SOL6/D2HElirnt5kSnqujFHO8n5Rkv1RKrjoBGA9rVpR1++/QFzckyvDLnL+8tIEoAQCjY+2KUq8eU/vv3HHpz/EXN/Qqw8MffaMtDQAAJWtWlLSFRN3+O/O51xsAMETWrCix/w4AYFKs6S9zAABgEkCUAACQAaIEAIAMECUAAGSAKAEAIANE2ZJ7r3tDbQAArD0gypZ8YdMvqjNnz0XDd+99z4RlSbccBrcqJlnN/dmJdmK3ZwIwQiDKlnzuf70xKkkKT+24Sn2vtSyN4Nz91v493BAlAH1glKJ8+OGH1UsvvWSP2rH12l9Sp8+cK8Kj+5bVhe/erP5w6atq72M3sSy/e+8fqLuv+SVbogb7UApfblpa3lOB5ihKAAAzSlHeddddauvWrerYsWM2pjl/9dFfVi+ffoXDqZVXPFG+rI8pjl7v/Ngv2xIpmogNogSgD4xWlEeOHFGf+tSn1MGDB21sM27f+Cb14qlXOLyggxTliy/reAo6/g6drxZaTWYfYRYKjI5Tl+lOlH4eT5zJx6olRMn5RXy0vGlXPiuTH9HmxpZsE4DhMFpRErSiXFpaUk899RQfN+HT69+kTr74ig5n1cmXfFGefEnH6bQTOv7T699sSyQInzDuCcXJSQrMCLDy8N4i3QjLk2eYvija89KaiLKmvDcWJ2z7PtkmAMNh1KIkDh06pK6++mp1/PhxG1PPlo/8ijr2wlm1/PxZ/XrGE+UxHbes45Z1+uarfsWWSODJRRLKMSYjRyCl4r2jGlc8kDcpZEG4otSky9svfRqXAWA4jFqUy8vLrVeUH//wv1A/OnHGhJO+KOn4iA70+okPv8WWSCHk4tFWlK6OjCjtirVYkXpCayDK2vLUPZNGUvTzpMsAMBRGK8qjR492+ozyf3/wLeqHx1dYkP/1joc5OFH+cPkMpx1aXlE36nw5zEorlGVClPw+cukdXPIm9+MJROulyXZYZpHVYW15DeVdWFSLhbg1uTIADITRirLrt96b/uRfqgNHjSgvvuIzhSQP6jiKP3CMXs+oP9P5GmFXXeWlqZRhuNIzsoxfxtrVY3I/HitSm7ag80VXlClR1pYnqqLOlwFgGIxSlKv5O8pr/vtb1b4frah9R1bUl584yIHeU9hLr5x2Wn3sA2+1JQaMJ0oAxssoRbkarn7/W9Wzh0+rZw6v8OuzxasJz9iwUecbOnypXPlcFIDxAVG2ZP37flV9+I8vVle9z4QPB69XUZoOlG+w0GeLfLmM1SQABEQJAAAZIEoAAMgAUQIAQAaIEgAAMkCUAACQAaIEAIAMEGVL5P44sQAAWHtAlC2Z7Z45s8beBjnTP56cR5trFO/e+vD2147IW1pHDETZksntmePug079Etr7ujN3xtBTe/z7q+N31DS7y6aJtPz7zVcvuEmKctJ9Wy2JsU3r1lCIcmqMUpT92DPHTKKFBfFYMoF50o6e8Dm5BU/ocfWGAnaPQasnJy0jojKd8q92MubaTBGWm0bfVktibEMSJWBGKcrVPD1o4nvmLMUmDaVp0S2FEoxQ+R/fTJBFLUZfGk1WBYmJ7aC2cv1pTabNJEG5qfRttSTGBlEOjtGKcu575ohJVFntuV/44hff5I0/izKYjBSvD3hF6iIrE9Osvtwlalmvq8tPLye6iS+PQ/xy1XvFY+0G/ee+6vQiIlYmaIfPQ7u+JcfMz9T0z7X/sUXTeiI/G0f483BjtqHMT3XZ/zBtmuxX5TxQ8PrZ4WdelLc06qupI3nOkuMbDqMVJTHXPXOKX1D9luRW/DIG8e6XTb7nw/IXTkqxiKdfTlnWZeYJI1eXcjKb957gvL5p+DjIw5iJ5k1kr2wknQnPQ7g6ru9rMSyitm8tx1yca5m3ZT1FXCy4fDpP7V5GOq8bJAvHtW/S5Pj58+qi35Qu62nTb4Enypq+Js9Z3fiGw6hFSbTZM+fI129X++58F78Sq9ozJ/xl0u9ZIvIXzvvlk7/schJoCilSPS5P+d5bsfIvqpusZTDpsk+OWBw1aT9DdQleXx2ibDSdsHn4gcPBBGrdV0O0b0EdFNL1iHMtRTGhc+fLx1D0mYNLiwnOHsfOpxcnfkc6nkemS18blxkOoxZl2z1zSJLq3HfMq2Z1e+YEv6D2l3wplJqYDPTLRmn8S+f9ZttJUQjTxvLqUkwuE5kQFhGbNHUTidq1adF6RdvJdk3963S+yrerrfsqyfXNEa/H/efizrmNbFlPoo9SJPxe/Mw9yQj5MFRfzfn04uzvRCU+JHMeG/eVmomcs0yZoTBaUbbdM+fIrhvUyp4N6h0XruPXI7tu5Pjue+aEv6BmYnv/24a/4PRLFu5LY2Ep0lYLMoHK67hFb5IIgVi26zzm0PRJStisBMRE8WaUnMim3kr73sT1x7vEecV5sJNK5sn1tUhr0LdG9Tii57ptPTV1u3Ma/Iy9883tyfapvtSYTFtRUVbyUrM1/eb+2XYa91UTO2e5MgNhtKJs+603rSKlKN2q0kmy/Z451V9Q/iXyf5u9XzKChBjGMZQ3mAw6kieIv/rU8C8/SdmEMtn2SU+i1GWS+UWPlSVse0UIJoTXrksLz4Orw6Yn+yr6Ys9Hbd9yY5Z5GRPf+tx52RN1cx3++F191b2MUqLU2J+5CTre+ysJKivOf5t+c96IKGv7Sth0v7JMmWEwSlG2/TvKffddqZZ3Xc6CfOLWi/l1eeflar+On/WeOe7yBoCZ4IlyvIxSlG2h1eP5Zzaq5d0f4BUlvZ5/eiPHz3TPHPzSghnDq/TYFczIgCgb8Mg1r1M/PrBZndyzpO6/+Z38qvZv5vhZ7ZnDl9zeJRMAU6S4rMd/zARE2YDnHr2DpRgGigcArH0gSgAAyABRAgBABogSAAAyQJQAAJABogQAgAwQZUvk/jixAABYe0CULVnbe+b0BHkLHQA9AKJsyUz2zInc4z15/Puye/WH7BAl6BmjFGWf9szhB1CEUmwsSltHIbnwOIWRpF8Od2AAkGKUouzy9CDHxPfM4edF1j2erI6OoqQVG+7fBaAxoxVln/bMMZeaQnAVUfqXyUaqfpx58K08ru79UtYbrihDYu0Rrs82PdKG/xCFpvUE0g4f/mHPj6vH9NvUkWw7WgaAboxWlERv9syhI36WopWDJ0qSify8Tpbz66gcB8Llh/vKNJZIeMmdb88r47Uh87asR+KJUucd6T4toD+MWpREP/bMIaw8KEIKgCe5WRXJYFZS8TrKYykrel+VRfGwW1eoVXuEaEMKrnU9gnBFqSn6ycGlJdq2xMsA0J5Ri7JXe+YQ9nLR+4JHSrNCTpRGFiQnlkbSTCQcW65Vewb3MGHXlo1sXU+BlJ49J0W9gRCjbWfKANCW0Yqyf3vmGIpVUCEZITFLer+TSJ0kiXAfE4rzMomVWav2LLE22tbDMkusTIVwzfkR0ou1nSsDQEtGK8o+7pljMPHeaozF4S4h/TKhWKuiJW8E9WmKfJE60+1l+hwmtKmH80ZE6eq2dYxpnxbQH0YpyiHvmdMFd3k6GDxRAjB/RinKttDqsRd75nRhgNLh1W6wAgZgnkCUDaBtH+a9Z04X+JLbu+TtOfTZIl8uYzUJ+gVE2QDsmQPAuIEoAQAgA0QJAAAZIEoAAMgAUQIAQAaIEgAAMkCUAACQYZCiPLnnAbX3jlfxK5gg8jbC2G2GfeHIVrX1I+9R3zhijwGYMoMUJUvysQv5tTHegxL8e4E5eHeCRNJr/wjaPADC5e3/H3gnJNhjUT792berT35Eh88+MhlRfu86ru/B79njgOMPvce0F4StDx2wOSSPqAeLPA36xf0v6/T7EK+rGP/NW1X+gYBg0kxVlKvZm6aOxze8iiXZalUZEaWUAN/FUkS0kUT4lBwq2/XOklnJqUk7s+pLM0gUKam144D6xs0knOvUg/q1cZ0st+vU0/awxNRXCJQFHMvnMCIs2vWkn6mLjiHKuTBVUXZ5Ss+6339Avfmqz6vXb7hPXfjRB9VPXf+wetVNf69+4pPf4TSiuPTepVeVtzRcVWZEyelFRAtJ0CpsYvclQ5QpJidKxwGWUtM6eYVJq9mQikBz9ZIo5apTHOfqgijnxtRF2XZvmp98+1W1wUGrypO7flbtWZqEKM1x+YSdNpKoPnfRENapEX3wH3NGK1D/8r3sqx9f1kfx+jJ5O10umzTuA7VRyRuSGJ/3AA2Xx28/PGeVfW+4jib56/b0qeKJ0hPKASsTe8laiERewsYumV05e1hLKDcBySsQKPU1foluYOlyP00fvBVkXV0Q5dyYuiiJtnvTvO6Tl2eDu/wmUTa6/I6I0k3m6t7aYboOVROWFHIKLrmDiU+X91yNJySJk4k9dDIs+ibTA0G5PrjCyTaIsB1LRJTemLiNmnSKS+5Vk6gvdn4i5ETpX+6GYjN5fCnG4hLUCCq20syJsuyz3+9sXRDl3JiJKIk2e9P8xIZfV1c+cFUyUDrJ8fFNr1KHH9CrSv2axZuUvij8zycJP70pxSqxKChFR++dJKzkEoIui1v5BcGswkKJ5o4lifFFV5R8YJFx6XNUXS1zbCS/7CO9FxINyInSEx4JRawmXfDlFSkXJZMvtwqsEEicx2KPc3VBlHNjJqJsuzcNiTAXCFpVkijpNQdP3mKWhpOWJqk8Tksgj18XtUti89t3mHZKYQbtBisun1CEuWNJYnyrFSWXF5fT2fooS5M9fTqIMiuUSLkYXlsRKm1l6o30rZBhri6Icm5MXZRt96Z56Iq3NQ7u8vvxK3OX32aSlp+HVSctT9TEirMWkoGXMRAUpUf2rFkqisi2wnZ96RLlvjOzEaWUF5+jOvEFYs/mJ2LnJ0IrUdrPJ2Xc058NZRcpJ1d3lujq0MsX1JOTWaUN2ddMXRDl3Ji6KNt+673jD35ZPfUX788GykdyfExL8vA9P8WvMdzDa/3VSmzSSjHY91SuCOmJbIRQ5g1lwH0IVoZFvyiIAkVdLj/Lq8xbZl29KIv2KVB7EVHyjpBFPpdG1JxDm9/fqyaW3xA7PyHtRKnhPOVld5lu8stL8iI9lFhFapZoPldXzerTEv6Nptf3urogyrkxVVF2+TvK7Ze8Rn33un9XhO9E3tMr5SNyouwDJIJyNQtCmpyftChHBEQ5N6Yqyi7c8xv/pAhfpNdfF8Eeu3iCBOlCL/FWaaBCw/NDouRV1mcfEX9e02fMJbVcOVKorHwbUowfopwLvRPlWsJdXscuN0GH80MrKhbOCFeTYK5AlAAAkAGiBACADBAlAABkgCgBACADRAkAABkgSgAAyABRAgBAhkGKsnhwb5PHq4HpUPvAjlXCf4Ref+83ALNkkKJkSTbeM8fdf5yaeHRPdP5e49ng3yttQk/v6oEowYgYpCjdU4OarSqNfBYWzOO8QioPoZgrkQdH2GdS9u7unmmKEoCeMTNR7ty5U23atMkepZn8njlWPkuxe4opTa9clvoy6SOiJPp4vzhECUbETES5Y8cOddFFF6kLLrjAxqSJ7ZMjg4NWlc32zCnlU3lKjZvs4aRnMZWXv0Zcph5ZnlejRTl7CW9Dmc8+7oxkXEkLSYiyEp9qy+Xz0/36uvbTL8fBE+Vk6uW0yn8Mqbrtz6BI6+nHFGDwTF2UTpKXXHJJI1ESsT1ywuAuv/N75gjJ8GWsm0xBfDHpdXxq35cwXyEvK4OiUJimJ7GzVe3nb7KcpGlb5r0nDG/MXftp0mS/+IEW3n8S3ev1xanxRFlTd0WoAEyHqYpSSvLSSy9tLEra6iG2V44LlE5ybLZnTlUkPDGl9DwBGuIrFTFp5SRlGbm8ZTACiE10eSyRfZWIMrVtxcqLuK79jJwfL26S9RKtzi0dy/oBmDxTE2UoybaizAWCVpX5PXMCedjJuSQvw+WE5Ukq0oJVi7t8J5FGy1eYgChl/bVtxcqLuK79jJVr3KcJiDJZt8OMEcIE02JqoqQvbkiMMlx77bU2NU1sb5xUcJff9XvmhPJwq5BSfnWT3qwsRV6axJU9XkydUlDpvW2EKCqEfdVQf7zydW1ZYYhEv/9d+xmWs+0U52lS9W5XS5Tg/edUU7fOF997CIDJMpMvc9ow6T1zYhOI5eHPPDHprQT05ORLPD0p5YqySA9nJE/uslyZXCeKEL9tDrHVVLItO1bd57IO2XdN136ysF05HR/+pUDXer1ypQC9c56sm7pVxld+JgBMiN6Jci3umTM7rCjhCwAmSu9Eueb2zJkpECUA06B3ogSrAaIEYBpAlAAAkAGiBACADBAlAABkgCgBACADRAkAABlGIcpvPvDH6m+2XKAe3Pxa9cAnX6u+/PHXqvv/z8+r+276eXXvja9WX7zh1ZwHAABijEKUJMkfnz+hfnz2h+r86X9U51/4e3Vu+UF1/vDd6tzBP1ev7L2B8wAAQIxxrig/8RpeUX7pplfbFeXPNVtR8q108na8DkyijlkwlH7OnSfVtg3b9L+gdxzdrbZs2KJ2H7XHXbB1jEKUzxxcVh/65APqmUMvqudfPsPh7Nmz+nWF4zhN58kyN1GaB0N490PH4LrLe59r//Dc3rudzDNzUR5Vu7dsUBs2yJASEMkpNgHa1DEpJiXK3JhSE57K6fQtu3XOeWDbt2HbXP7HSJy7MYry4YcfVi+99JI9as7fPf6suuHOv1P7j55Sx54/rV48tcLh9Jkz+vWMOqrjKI3yUN7Z0uROGspTypEfAhEtEDxlJyk60+Y6fgJSn+7iMULwJtqT25KT7+juLWpLdWa0qmMyTEqU9WPasiWWZsqwpOYiSiPJ8txSX+ezuo6fu8kxGFHeddddauvWrerYsWM2phl/cd8/qK1ffVIdOHZKHX9RC3LlDIfz587y6/EXVtRBnUZ5KO9s6XDLYfAYuJLwKT3hcUjfbneMSI7g/9Ejk4/iK3JoWcdEmJwoa8e0OzYGStMrpt36P4N5iDLa3zkx5b4MSpRHjhxRn/rUp9TBgwdtbJ6Pffor6m+/eYBXjUefX1Ev6dUkhXJFuaL26bTnjr7EeWvhVVrdo8DcsZVUbJ+YIp+8nKYVXkx+VSr7/gj48XFcj5FgKp8hI8ro+Mr+luVcPXY8DcdRJSE5Gc/Cc5dSsfwN6mD8y0WzEjF55KqEV2vF5IuVcfFSYH4+/9Lf9cPPU/arfkxPbvP7x6tl6p97tdHmPIX1r2Z8VsbRtLC/jtxYNdF+Our6E4uPnDuu355/+Z7wjmvGaPMNSpQErSiXlpbUU089xcc5/ui6e1iG9//NN9Wr3vAf1c233a+On3iR358+c86Lfzh36S3lERWJFKWWhrMJp9nVnZev4aqOy4SCimHqMzITfYvSRpQ6b2ofoaLNXHs5YpIgRDz/0orPnEgQ/szI1+EmhatDpnnCaViG0+SEk5NXw5f+Lt2U8+TppWvqxhSpK9rvbUKaskyYr/H4dJ9dn2I/A5aLGANj6kiPtaaftk3vPDJ1/dRQHcWBRsrQE6PGO64Zo803OFEShw4dUldffbU6fvy4jUnzuxvuVssvnmEZnjh6gl9fPH3Oe3Xxu77xtC2VQMrDE4nGOw4ve0kmTUQpV5nxy2Z/Uy9J0Ca3E6/D0EaUBvO0dNe/1Bhi2F9EDvIXXRL80hdQfKoM1St++ZvUUUxsP5hJKSainEjZMiKfXNkxsk+x/oVxdWMy77ld2Vak3eKzSw5SCF3GJ88/9aH68yjaKwbSZKyiHIe686ip7Sdn8M+dHKN8T3jHNWO0+QYnyuXl5VYrymGJsglh3ZbIZ5d1l+nZtitjjX18wAcdxhAjNrE0qUlj8S9HG9TRsD6awEW9tWXE5IzmE5OO3+flUTsm28ZumUe2yxNbpAWC6Da+vCgNlNf1NTPWun6m+lPbT4N37mSdwXnwj9eYKI8ePdr6M0q69D584hRfWpMM6fXEy6/w+5P6Vca3v/QuhVXdm2ZCoqT8IkP5OSQflH0I+mP6YOuupBGRtiv12X4GEvbHOkVR0sSQv8D8SxtMUoorJk+DOnhS+Hme3BZMoC3b1DZPBnVlKE2+FxOV8Ca36Z+8PDQrKtE+UTsm04ZXRrYRyKRSf6fxybyBRGQhL29mrLX9DPvzpNrNldb10yLPHb13dfL7chzV9mrGqPMNSpRdvvWmL2h2fGOPOvbCGV5ZLr94VgQTR2nP6VVlqy9z+LC8FPX31mkqSlFHzZcgsh3vs8BAgH4+IS8vnxGbzFfklfm8fvpl/LFOVpTeZZWYSEzwy24Qv9RN6iC4njKPN9ddHX5kTRmaZHKymsns8nmSsnVv05M7nu6ojkl2hye5bwsxTv8cbNFteSspl95qfAmJ0BELJ1bO9js51kw/vf6k4v3zYhD947xlWdlXv701JMquf0dJf/LzwEMPqf2HnlHf33dIPbH3GIdvP3tch2PqSR134NCznCf750GB5NY0AxprRRy9xcqjQVeHM6YUzcc6aYpzF4hyNQxGlF2hPyK/5e4H1bkXvqVOnXhCnTz2JIfjR/eok8tPqlMnn+A0ypP7g3NesdWs/NYSwxpruKrrK23kMZQxpZifKN25e4yEGbui6MCaFyVBAvzgx+/VJ+0+dfUt99rwRX6lOEqrlaS93W/1fwIzAMY01pkzT3nMmjmOlT6K4Evsyf1HMwpRAgDAaoAoAQAgA0QJAAAZIEoAAMgAUQIAQIbRiBL75gAAujIaUWLfHABAV8a7ouy6b06voVsn3d8/yvdDok2/w1tFJ4x36ydIM/Q/js8zGlFObN+cXtNOlPzINnv/NofknThUl8tXJ46m+Qh7/3jlJvF8v0so7ypEZv+4Pnmf+sxFaf5I292PXP9H0+H9yY42dUyKSYkyN6ZYGkHldPqE7sKJMRhRdr3Xm6C7bua7b0744IhJPUgiREomL5z6x7A5TF+LfCyXWL1N81lIQgsLkfvJZyFKK2nsGzQhJreirBvTPPcNGowouz49iJj/vjkDFmXl4RiJvjfNZ6F7yalt6oOfZxaidEzr59CViOSI1MMdKL4ih5Z1TITJibJ2THPcN2hQouyyZw7xze8f5D1xXjz9ir7UPruKfXPsxIzthcNQurv0dGl+3DpeRcljs6rx6qHVWN0DKVhKZR3lRJeSke/j+JfeibzUl8AkUcE2zceQoKzgKmOV/XYi88+hP17/5+H1IXmeHBlRhvJP1hf0s/PDRBKSk/EsPHcJGsvfoA7GXq7aYFZqJo9ctfFqrRBQrIyLlwLz88Uerza0fYMGJUqizZ45X1r61Uq4/XM71Je+8g8d982xE8HNEJ44bkVjJ20xQ+QkDCdkcBzIorrKkuiyyf1rqA+x93lSTwvi+KAzMQE2zcd44w3Pm+y3OU+exCvjTf086s6TI/y5BHiirKsv0s9OxCRBiHhPlBoShFegQR0sBPl5n0jzhNOwDKc5GRrZVGRWpJtynjy9dE3dmCJ1Rfs94X2DBidKoumeOV+48W3qzNlzRXhqx1U67mKWZbftIMJJTRPEHvPEocniByOKcEKGx7JeKQorAg6yXV0DialIk/lT7+P1lFCeSBqNq4kAm+bThPH+sex3eJ4IGRf2Wfw8LPHz5IjVLwhXlJp4fZl6GCMQs1qRE1IiJ6eE4lNlpKSIBnWwOMqVkwtGbkIY8nI9WyYmIofsU6x/YVzdmMx7ble2FWm3+OySg6uv2/gGJ8o2e+Z85s/+tTq98oo6ZcPex25iWVL8VESZvOQKJ1J1YtEEJFnEVmYe9vKvEIs3maVk5PsmhGOzVMaVkELTfNyOE40MsX7H6pBxYZ8pzR7XnidHqo8WWaa2vkw9jYlJRBOVT0ntHjuOjFQk3fbVyYnSiT7Wv2pc7ZhsG7PcN2hQomy7Z85t1/4b9cLLr6jPffV76vq7HuP3L7x8luO77ZtTMzE5zZ8s2xdTEykysWji8eeVEVlJAiGZFY5rR0pGvo+h00UHaFVX1MsScP0I+irb75KP4iv9kudO9tvUKf/jqI5Xni/KL9pJnidH4ufg6uT3tkxtfZF6OhGRCE1guQINL70JiismeYM6WGyhmMQKjuvDvkFyfIMSZdtvvW+++u3q+Av0rfZZdfzFMlB8t31zaiYmH9LEKldJcuKYiVXKKDwmPFklsfKwbVT36om9T8DSsnXJdj0BumPXpqizQz4eY8QoZXxVlIt6jEU/vTHV/TzqzpOf5gI3L8fE7+NlsG9QKC4pOicyF2SalZ6WUDzdUR2T7A7Lz7daVca2/knsGzQYUXb5O8rrr/pN9aMTZ8yK8jOPqss23a8O6+MbPvIb3ffNmSL+Z3VgcgLqiCfKflMRR2+pSi9Fn8Y0GFF24WMf+vfqueXTIqyogzpQfNd9c6bGgCbl7JivKHnVn13h94VwVddXmouyT2Na06Jc/ye/lQyt982ZInzZ6S79gGBOoiw+ksB/XJOnjSj7w5oWJQAATAKIEgAAMkCUAACQAaIEAIAMECUAAGQYhSixXw4AYDWMQpTYLwcAsBrGuaLs7X45DW47nAXyNr5ZMOv2BstQ/qh87TEKUQ5nv5wBiZLzlPc+p/4o3P0xfRFid7rMXJT+vcAmpAREcgrvrSba1DEpJiXK3JhiaQSV0+mxe8dngm3fhln+0fpgRNl1z5z575fThqainPM90NTPykM04v3u5/3rkbtD+Ak78clH9xx7T8Nh2tUxGSYlyvoxzXNvmjRGkuW5pb7ObnU9GFF2eXoQMf/9ctowFFGGUH/iK8LBiJLgp8dEJh/FV+TQso6JMDlR1o5pjnvTJIn2d3YMSpRd9syhx6b97TcP8KqR9sbpvl+OoXg8GgcpNZJceYlZysFJzaZH9sgpH74QijJWpx9X+9CG5OVx0KcwvWaFGCfsd4l/6Z2oM2yvab87P7AiITkZz8JLP+arUR2Mf7loVmomj1y18WqtEEGsjIuXAvPzRR9nNrC9afgjAZJxNC3sryM3Vk20n466/pi4QYmSaLNnDvFH193DMpT74nTbL0eTFAhNXLmikis+896ThPcQWJlXCidfZymQGDpPmz1eZHpLUTZdNSafxuO117LfnYhJghDxnig1JAh/5uXrcBPf1SHTPOE0LMNpToZmEldkVqSbcp48vXRN3ZgidUX7PeG9aVhMrk+xnwGLS4yBMXWkx1rTT9umdx4Zv5+DEyXRdM8c4nc33M0P5iUZuu0eum0DQdiVTPjFQ/G0GT8YecSkJiToSUKIslWdrl8U/L7FV8CxPom4Sp/idRO8Yqw3tkCMWxIRc/N+h9jJxkFOSImcnBKKT5WheuUEbVBHMbH9YCalmIgsBFt3tozIJ1d2jOxTrH9hXN2YzHtuV7YVabf47JKDFFCX8cnzT32o/jyK9oqBNBmrKMeh7jxqgn4OTpRt9swhJitKh5mwhThIasnLwPjkdqswEkK5GgtE2bJOD5aPWOmFq7ZKeREXEVeMdpIkGoiydb+7EJtYmtSksWBvmjLONGEuZ4s0KURNt/HlRWmgvK6vmbHW9TPVnyB+UKJsu2cOQZfeh0+c8vbF6bZfjkZP2qVikspJa1ZdcgKn98uxkAAqe+QIUXapUxKI1qzQ/PLJvWg8OcUw5UvBC7isG5Meg2iDxer6JPPJ9hr0u3bcjYhMLJoYcpLyZAomKcUVk6dBHd5kNmBvmtz4ZF7qjz2mumQhL29mrLX9DPvzpNrNlfrxgxJll2+96QuaHd/Yw3vimP1x3F45bffLMfBk58vBYDXFk71MK5NSk7sqKxaLFFSyTkqyl6aZVacrG93jRce59FJGGimuGNGPBaT0hPxlXtlXmc9rr0G/kx1rip1YLAEbxERiaGKGopQTt0kdBNdT5vHmuqvDj6wpQ5NXiMhOZpfPl6Cpe2h709StKI3gYuVsv5NjzfTT6088fjCi7Pp3lPQnP7QXzv5Dz6jv7zvEe+X0cb+c2TIp4UyInJh7REUcvcXKo0FXhzOmFM3H2pXBiLIr9EfktBcO7Ylz6sQTvFdO7/bLmTn9EiWvjpMr474Rrur6Sht5DGVMKSDKiUACpD1xaG8cs1dOf/bLmQ89EWVxWT6M1eSwmL48+gNECQAAcweiBACADBAlAABkgCgBACADRAkAABlGIUrsmQMAWA2jECX2zAEArIZxrii77pkT3p7Xmp7dETMWVv1zGwtD/8Pz6TEKUU5szxyIcvXwOSzv5U6eCy9fg3Nu8+cf1DELzB9Au3uLK/cQe4T3Nzva1DEpJiXK3JhiaQSV0+mxe+Zngm3fBvkH7IMR5drYM2fsotzecK+d4MlJwROFqtB5XVAL+txGRTlzIneK0MMkgsnnoHutvacAMe3qmAyTEmX9mIa4J89gRNn16UH92jMHK0ofI7iK2ypiTOSz0L3iJEj3jM/5E5EcwU+jiYiI4ityaFnHRJicKGvHNMA9eQYlyrnvmROugLzLw1CAZlXk0swEDkTpytuI4tFpHORKy6+rmqYlslQ+ziwvi1jfqvF+O67vNk8hslRdTaCykRVlVJSJ/2DoHNq8SVE2/rmlxtiWhORkPAvPXYLG8jeog/EvF81KzeSRqzZerRUiiJVx8VJgfr7Yo8vGsifPoERJ9GfPHD2pknu7mIlWnbRiwnN+sUoKJ3NBpK5IW8VzLbmeus/jUn3LtWP6HpV0UaRGaBHqxSbq4X7E6vXbaybKup9bbIxdiEmCEPGeKDUkCK9AgzrcxC98IdI84TQsw2lOhkYcFZkV6aacJ08vXVM3pkhd0X73ZE+ewYmSmNueORGZRVeBNPmiqxE7sfmBueFktMILJRetSwoiJit37OoU9ab6lm1HvrewZFz9ZTCyirQt4AcgV81XIuvW/VparNbB517U0XhFqYmv3iNjrGAnGwc5ISVyckooPlVGSopoUEcxsf1g5CaEwUIQgqktExORQ/Yp1r8wrm5M5j23K9uKtFt8dsnB1dd1fPL8Ux+qP4+ivWIgAxTlXPfMkRPOrnqKiSnTUjKyE3EdffEQkYfB5qkVG+Vx5etEGSHVt2w7pl8VUUbHWU9WkhVojOF/LO48RUJYd9OfW2yMnYhJRBOVTwn25CnjTBPmsrtIk0LUzHJPnkGJsg975qRkaFYobsKZ1VQ54bZruVNOMRHthC3y6OO6/Xi8lZLXdktRJvuWaycmkbAuKhIKTWLqSK/64v32Vopd8vH7Jj+32Bi7EJEITWA5ScPLPoLiikneoA5vMhuwJ09ufDKvECXVJQt5eQcmyrnvmSMnnJ1UbhXj7+2i4bwuPTURjWhcOq+0XBlvtrp8Loh2OK2NKDXRvhF17SQk4tWVkQxJSuQ1QcrM9Ts4t3IwXj6fRqKs/bklxtgaKxGWgA1iwjM0MUNRyonbpA6C6ynzeHPd1eFH1pQhOUjROZG5INNM3WPZk2cwouzFnjnehAODYUA/t4o4ektVeimGM6YUAxJlV+iPyCe1Zw5fpnX4TA7Ml2H93MJVXV9pLsrhjCnFCERJkABXtWdOccmI1eSgwM9tirQR5dAZiSgBAGA1QJQAAJABogQAgAwQJQAAZIAoAQAgA0QJAAAZIEoAAMgAUQIAQIbeivJr17/ZCwAAMC+mKsqu92dve+9r7LuSWBwAAMyCqYqyyxN/vnbNm9XK4Vs4nNyzpA4/vknt3XWl2nPP+zgtDAAAMG2mLsq2+9x89Zo3qpWTjzUKlLcJ9U+zto8W857v6PIGj/gCAIySqYuSaLPPzVfXa1EevqdRuO2yn7Wlakg+Yss9l1CmGUlCjgAAyUxESbTZ5+bI129X++58F78S2654faMQx60Qw4e9Rh7SGjz9GgAAiJmIsu0+NyRJde475lWzsveW2kCfY6ZF6XArSP8p2hAlACDH1EXZdp+bI7tuUCt7Nqh3XLiOX4/supHjV/ZsioasJPWld3wvmogo7eqzjHP7yQAAxszURdn2W29aRUpRFqvKxzdUQrOVJC0Uyy9nyr1oYqLU8GeaLj8e+AoAmLIo2/4d5b77rlTLuy5nQT5x68X8urzzcrVfx6887oemkgQAgNUyVVG2hVaP55/ZqJZ3f4BXlPR6/umNHH/b4i9UAgAAzIJeifKRa16nfnxgM/+h+f03v5Nf1f7NHA8AAPOiV6J87tE7WIphoHgAAJgXvRIlAAD0EYgSAAAyQJQAAJABogQAgAwQJQAAZIAoAQAgA0QJAAAZeitK7JkDAOgLUxVlP/bMSTz8YibMs20AwKSYqii7PD2I9sGZ7J45ECUAYHVMXZTz3TPH3/+meCiv9yg1KTInNlsuuo/OglpaCh/w67djtpJItA0AGBxTFyUx1z1zCvnZQzpeFNKip5oHG47F9tEJZepLVG4zIdsL2wYADJGZiJJoumfOl0iUe+/wAj13skmIE5dV/c6MfGCIbQ8h41i0rp4ymFUlRAnAWmAmomyzZ862Ky5SK3uWikACjO2TI0P9Q3wDWdnL7mKnRW+Xxo6iDNMLIEoA1gJTF2XbPXPufO9rtCDNfjgsSbE/Tizkn3QeyCoQm1lZ1oiy0aW3X2b7Yl19AIChMXVRtv3W+7bLfoa3emBJRvbJkaHpdhDFZTbLzYqOjmllqaVWu6IkvC9/Il/mJL8cCtsGAAyRqYqyy99R3vTOn7aSrO6TI8Nc98ypvdwGAKw1pirKrsT2x4mF2UCrTLfiJMyldvEZJwBgzdNLUfaO4NIakgRgXECUAACQAaIEAIAMECUAAGSAKAEAIANECQAAGSBKAADI0FtR3nvdG2oDAADMit6K8gubflGdOXsuGr5773tGIkv643b5x+4AgHnQW1F+9tpfikqSwv97aONIZAlRAtAHei3K02fORQOJ0smS8q1dIEoA+kBvRfmXH32Tevn0KxxOrfiBZEmvlEb51i4QJQB9oNeifP7lV9SOb+3l8P39x/mYXl0cHedF6R6dZh5mEXsUmnvQhUurbgWxoJa2l/d7c1l6gpA9jt377T/nkrLrvKZgi/ogSgD6QG9FueUjv8IivPDdmzl88NN/y8f06uLomPLV454/KYTDUnLHRpKe7CLpxWPVnNCcab0npPuQHLleKlM8lq1NfRAlAH2g16I89sJZFuKb3nsrBzp27ymejpuK0nnIIOI8iTlkGZKV3DwsdyyxUmxVXh7Te4gSgHnTa1EeOr5SrCbp9aZt/+Ad/+jkmSmKUsqqjegklAZRAjB0eivK6z+4UIiSBPlbf/pZfk+vTpiUTvnqMVIsLm01/ueHRmaVS2/vUrmh2PiyuUxzl97cXpf6+D1ECcC86bUo9x8pRenkKN9TelNRLi7azwI5hPIhIbm0ML2F2IQo+cubQo5S1i3q4/cQJQDzprei/OgVb2UR3vPwM+qxPUfV9/Y9z+/plY7pPaVTvnrEZTYAAHSg16J89vBpHVaCVz9AlACAadNbUV71vosbh3ogSgDA6uitKAEAoC9AlAAAkAGiBACADBAlAABkgCgBAKAWpf4/MDndRMAEUFMAAAAASUVORK5CYII=)

pom.xml

    
    
    <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
      <modelVersion>4.0.0</modelVersion>
      <groupId>Socket</groupId>
      <artifactId>S</artifactId>
      <packaging>war</packaging>
      <version>0.0.1-SNAPSHOT</version>
      <name>S Maven Webapp</name>
      <url>http://maven.apache.org</url>
      <dependencies>
        <dependency>
          <groupId>junit</groupId>
          <artifactId>junit</artifactId>
          <version>3.8.1</version>
          <scope>test</scope>
        </dependency>
        <!-- netty -->
    	<!-- https://mvnrepository.com/artifact/io.netty/netty-all -->
    <!-- https://mvnrepository.com/artifact/io.netty/netty-all -->
    <dependency>
        <groupId>io.netty</groupId>
        <artifactId>netty-all</artifactId>
        <version>5.0.0.Alpha1</version>
    </dependency>
    
    
    	<!-- https://mvnrepository.com/artifact/javax.servlet/servlet-api -->
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
        <scope>provided</scope>
    </dependency>
    	<!-- https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core -->
    <dependency>
        <groupId>com.fasterxml.jackson.core</groupId>
        <artifactId>jackson-core</artifactId>
        <version>2.9.4</version>
    </dependency>
      </dependencies>
      <build>
        <finalName>S</finalName>
      </build>
    </project>
    

NettyServer.java

    
    
    package websocket;
    
    import io.netty.bootstrap.ServerBootstrap;
    import io.netty.channel.Channel;
    import io.netty.channel.ChannelInitializer;
    import io.netty.channel.EventLoopGroup;
    import io.netty.channel.nio.NioEventLoopGroup;
    import io.netty.channel.socket.SocketChannel;
    import io.netty.channel.socket.nio.NioServerSocketChannel;
    import io.netty.handler.codec.http.HttpObjectAggregator;
    import io.netty.handler.codec.http.HttpServerCodec;
    import io.netty.handler.codec.string.StringDecoder;
    import io.netty.handler.codec.string.StringEncoder;
    import io.netty.handler.stream.ChunkedWriteHandler;
    
    import javax.servlet.ServletContextEvent;
    import javax.servlet.ServletContextListener;
    
    public class NettyServer implements ServletContextListener {  
          
    	public static void main(String[] args) {
    		new NettyServer().run();
    	}
        public void run(){  
    	   	  //boss
    	       EventLoopGroup bossGroup = new NioEventLoopGroup();  
    	       	//worker
    	       EventLoopGroup workGroup = new NioEventLoopGroup();  
    	         
    	       try {  
    	           ServerBootstrap b = new ServerBootstrap();  
    	           b.group(bossGroup, workGroup);
    	           b.channel(NioServerSocketChannel.class);  
    	           b.childHandler(new ChannelInitializer<SocketChannel>() {  
    	           	  
    	   			protected void initChannel(SocketChannel e) throws Exception {
    	   					e.pipeline().addLast("http-codec",new HttpServerCodec());
    	         	        e.pipeline().addLast("aggregator",new HttpObjectAggregator(65536));  
    	         	        e.pipeline().addLast("http-chunked",new ChunkedWriteHandler());  
    	         	        e.pipeline().addLast("handler",new MyWebSocketServerHandler());  
    	   			}
    	   			
    	           });  
    	           // Start the server.
    	           Channel ch = b.bind(8082).sync().channel();  
    	           // Wait until the server socket is closed.
    	           ch.closeFuture().sync();  
    	             
    	       } catch (Exception e) {  
    	           e.printStackTrace();  
    	       }finally{ 
    	       	// Shut down all event loops to terminate all threads.
    	           bossGroup.shutdownGracefully();  
    	           workGroup.shutdownGracefully();  
    	       }  
    	         
    	   }
    
    	@Override
    	public void contextDestroyed(ServletContextEvent arg0) {
    		
    	}
    
    	@Override
    	public void contextInitialized(ServletContextEvent arg0) {
    		 System.err.println("nettyListener Startup!");  
    	        new Thread(){  
    	            @Override  
    	            public  void run(){  
    	                try {  
    	                    new NettyServer().run();  
    	                } catch (Exception e) {  
    	                    e.printStackTrace();  
    	                }  
    	            }  
    	        }.start();  
    	      
    	        System.err.println("nettyListener end!");  
    		
    	}  
          
    }   

NettyServer类实现了ServletContextListener，通过listener来启动netty服务。（暂时未做将netty服务配置到spring中）

Global.java

    
    
    package websocket;
    
    import io.netty.channel.group.ChannelGroup;
    import io.netty.channel.group.DefaultChannelGroup;
    import io.netty.util.concurrent.GlobalEventExecutor;
    
    public class Global {
    	public static ChannelGroup group = new DefaultChannelGroup(GlobalEventExecutor.INSTANCE);
    }
    

MyWebSocketServerHandler.java

    
    
    package websocket;
    
    import io.netty.buffer.ByteBuf;
    import io.netty.buffer.Unpooled;
    import io.netty.channel.ChannelFuture;
    import io.netty.channel.ChannelFutureListener;
    import io.netty.channel.ChannelHandlerContext;
    import io.netty.channel.SimpleChannelInboundHandler;
    import io.netty.channel.group.ChannelGroup;
    import io.netty.channel.group.DefaultChannelGroup;
    import io.netty.handler.codec.http.DefaultFullHttpResponse;
    import io.netty.handler.codec.http.FullHttpRequest;
    import io.netty.handler.codec.http.HttpResponseStatus;
    import io.netty.handler.codec.http.HttpVersion;
    import io.netty.handler.codec.http.websocketx.CloseWebSocketFrame;
    import io.netty.handler.codec.http.websocketx.PingWebSocketFrame;
    import io.netty.handler.codec.http.websocketx.PongWebSocketFrame;
    import io.netty.handler.codec.http.websocketx.TextWebSocketFrame;
    import io.netty.handler.codec.http.websocketx.WebSocketFrame;
    import io.netty.handler.codec.http.websocketx.WebSocketServerHandshaker;
    import io.netty.handler.codec.http.websocketx.WebSocketServerHandshakerFactory;
    import io.netty.util.CharsetUtil;
    import io.netty.util.concurrent.GlobalEventExecutor;
    
    import java.util.Date;
    import java.util.HashMap;
    import java.util.Map;
    import java.util.logging.Level;
    import java.util.logging.Logger;
    
    
    public class MyWebSocketServerHandler extends
    		SimpleChannelInboundHandler<Object> {
    	private static final Logger logger = Logger
    			.getLogger(WebSocketServerHandshaker.class.getName());
    	private WebSocketServerHandshaker handshaker;
    	public static ChannelGroup group = new DefaultChannelGroup(GlobalEventExecutor.INSTANCE);  
    
    	@Override
    	public void channelActive(ChannelHandlerContext ctx) throws Exception {
    		// 添加
    		group.add(ctx.channel());
    		System.out.println("客户端与服务端连接开启");
    	}
    
    	@Override
    	public void channelInactive(ChannelHandlerContext ctx) throws Exception {
    		// 移除
    	group.remove(ctx.channel());
    		System.out.println("客户端与服务端连接关闭");
    	}
    
    	@Override
    	protected void messageReceived(ChannelHandlerContext ctx, Object msg)
    			throws Exception {
    		if (msg instanceof FullHttpRequest) {
    			handleHttpRequest(ctx, ((FullHttpRequest) msg));
    		} else if (msg instanceof WebSocketFrame) {
    			handlerWebSocketFrame(ctx, (WebSocketFrame) msg);
    		}
    	}
    
    	@Override
    	public void channelReadComplete(ChannelHandlerContext ctx) throws Exception {
    		ctx.flush();
    	}
    
    	private void handlerWebSocketFrame(ChannelHandlerContext ctx,
    			WebSocketFrame frame) {
    		// 判断是否关闭链路的指令
    		if (frame instanceof CloseWebSocketFrame) {
    			handshaker.close(ctx.channel(),
    					(CloseWebSocketFrame) frame.retain());
    		}
    		// 判断是否ping消息
    		if (frame instanceof PingWebSocketFrame) {
    			ctx.channel().write(
    					new PongWebSocketFrame(frame.content().retain()));
    			return;
    		}
    		// 本例程仅支持文本消息，不支持二进制消息
    		if (!(frame instanceof TextWebSocketFrame)) {
    			System.out.println("本例程仅支持文本消息，不支持二进制消息");
    			throw new UnsupportedOperationException(String.format(
    					"%s frame types not supported", frame.getClass().getName()));
    		}
    		// 返回应答消息
    		String request = ((TextWebSocketFrame) frame).text();
    		
    		
    		
    		String news = "4564";
    		Map<String, String> map = new HashMap<String, String>();
    		map.put("id", "123456");
    		
    		System.out.println("服务端收到：" + request);
    		if (logger.isLoggable(Level.FINE)) {
    			logger.fine(String.format("%s received %s", ctx.channel(), request));
    		}
    		TextWebSocketFrame tws = new TextWebSocketFrame(new Date().toString()
    				+ ctx.channel().id() + "：" +news+map);
    		// 群发
    		group.writeAndFlush(tws);
    		// 返回【谁发的发给谁】
    		// ctx.channel().writeAndFlush(tws);
    	}
    	private void handleHttpRequest(ChannelHandlerContext ctx,
    			FullHttpRequest req) {
    		if (!req.getDecoderResult().isSuccess()
    				|| (!"websocket".equals(req.headers().get("Upgrade")))) {
    			sendHttpResponse(ctx, req, new DefaultFullHttpResponse(
    					HttpVersion.HTTP_1_1, HttpResponseStatus.BAD_REQUEST));
    			return;
    		}
    		WebSocketServerHandshakerFactory wsFactory = new WebSocketServerHandshakerFactory(
    				"ws://localhost:8082/websocket", null, false);
    		handshaker = wsFactory.newHandshaker(req);
    		if (handshaker == null) {
    			WebSocketServerHandshakerFactory
    					.sendUnsupportedWebSocketVersionResponse(ctx.channel());
    		} else {
    			handshaker.handshake(ctx.channel(), req);
    		}
    	}
    
    	private static void sendHttpResponse(ChannelHandlerContext ctx,
    			FullHttpRequest req, DefaultFullHttpResponse res) {
    		// 返回应答给客户端
    		if (res.getStatus().code() != 200) {
    			ByteBuf buf = Unpooled.copiedBuffer(res.getStatus().toString(),
    					CharsetUtil.UTF_8);
    			res.content().writeBytes(buf);
    			buf.release();
    		}
    		// 如果是非Keep-Alive，关闭连接
    		ChannelFuture f = ctx.channel().writeAndFlush(res);
    		if (!isKeepAlive(req) || res.getStatus().code() != 200) {
    			f.addListener(ChannelFutureListener.CLOSE);
    		}
    	}
    
    	private static boolean isKeepAlive(FullHttpRequest req) {
    		return false;
    	}
    
    	@Override
    	public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause)
    			throws Exception {
    		cause.printStackTrace();
    		ctx.close();
    	}
    }
    

web.xml

    
    
    <?xml version="1.0" encoding="UTF-8"?>
    <web-app xmlns:javaee="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
      <javaee:display-name>Archetype Created Web Application</javaee:display-name>
      <listener>  
            <listener-class>websocket.NettyServer</listener-class>  
        </listener> 
    </web-app>

html

    
    
    <!DOCTYPE html>
    <html>
    
    	<head>
    		<meta charset="UTF-8">
    		<title></title>
    	</head>
    	<script type="text/javascript">
    		var socket;
    		if(!window.WebSocket) {
    			window.WebSocket = window.MozWebSocket;
    		}
    		if(window.WebSocket) { 
    			socket = new WebSocket("ws://localhost:8082/websocket");
    			socket.onmessage = function(event) {
    				var ta = document.getElementById('responseText');
    				ta.value += event.data + "\r\n";
    			};
    			socket.onopen = function(event) {
    				var ta = document.getElementById('responseText');
    				ta.value = "打开WebSoket 服务正常，浏览器支持WebSoket!" + "\r\n";
    			};
    			socket.onclose = function(event) {
    				var ta = document.getElementById('responseText');
    				ta.value = "";
    				ta.value = "WebSocket 关闭" + "\r\n";
    			};
    		} else {
    			alert("您的浏览器不支持WebSocket协议！");
    		}
    
    		function closeweb() {
    			alert("www");
    			socket.onclose;
    		}
    
    		function send() {
    			var message = document.getElementById('msg').value;
    			if(!window.WebSocket) {
    				return;
    			}
    			if(socket.readyState == WebSocket.OPEN) {
    				socket.send(message);
    			} else {
    				alert("WebSocket 连接没有建立成功！");
    			}
    		}
    	</script>
    
    	<body>
    		<form onsubmit="return false;"> <textarea type="text" id="msg" name="message" value="" style="width: 1000px;height: 90px;">
    			
    		</textarea> <br/><br/> <input type="button" value="发送 WebSocket 请求消息" onclick="send()" />
    			<input type="button" value="关闭" onclick="closeweb()" />
    			<hr color="blue" />
    			<h3>服务端返回的应答消息</h3> <textarea id="responseText" style="width: 1024px;height: 300px;"></textarea>
    		</form>
    	</body>
    
    </html>

这是一个简单的通信例子是通过group群发的，也可以通过channel.writeAndFlush()实现单一转发，但在一次通信的过程中，只能对一个channel进行消息的转发。在netty5中无法通过遍历Map实现群发。如果要实现定向的群发，可以遍历map加入到group中，然后实现群发，不会出错。

    
    
    Map<ChannelId, Channel> map = new ConcurrentHashMap<ChannelId, Channel>();
    
    
    ChannelGroup group = new DefaultChannelGroup(GlobalEventExecutor.INSTANCE);
    
    
                                  for (Channel ch : map.values()) {
    					group.add(ch);
    				}
    				group.writeAndFlush(tw);
    				for (Channel ch : map.values()) {
    					group.remove(ch);
    				}

