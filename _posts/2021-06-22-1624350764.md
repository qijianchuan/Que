---
title: MongoDB之——数据导出导入
categories: 精通分布式数据库系列
tags: MongoDB
---
转载请注明出处：https://blog.csdn.net/l1028386804/article/details/80000608  

### 一、数据导出 mongoexport

作为 DBA，经常会碰到导入导出数据的需求，下面就介绍实用工具mongoexport和mongoimport的使用方法，望你会有所收获。  
假设库里有一张 user 表，里面有 2 条记录，我们要将它导出  

    
    
    > use my_mongodb
    switched to db my_mongodb
    > db.user.find();
    { "_id" : ObjectId("4f81a4a1779282ca68fd8a5a"), "uid" : 2, "username" : "Jerry", "age" : 100 }
    { "_id" : ObjectId("4f844d1847d25a9ce5f120c4"), "uid" : 1, "username" : "Tom", "age" : 25 }
    >

#### 1、常用导出方法

    
    
    [root@localhost bin]# ./mongoexport -d my_mongodb -c user -o user.dat
    connected to: 127.0.0.1
    exported 2 records
    [root@localhost bin]# cat user.dat
    { "_id" : { "$oid" : "4f81a4a1779282ca68fd8a5a" }, "uid" : 2, "username" : "Jerry", "age" : 100 }
    { "_id" : { "$oid" : "4f844d1847d25a9ce5f120c4" }, "uid" : 1, "username" : "Tom", "age" : 25 }
    [root@localhost bin]#

参数说明:  

  * -d 指明使用的库, 本例中为” my_mongodb”
  * -c 指明要导出的表, 本例中为”user”
  * -o 指明要导出的文件名, 本例中为”user.dat”

从上面可以看到导出的方式使用的是 JSON 的样式  

#### 2、导出 CSV 格式的文件

    
    
    [root@localhost bin]# ./mongoexport -d my_mongodb -c user --csv -f uid,username,age -o user_csv.dat
    connected to: 127.0.0.1
    exported 2 records
    [root@localhost bin]# cat user_csv.dat
    uid,username,age
    2,"Jerry",100
    1,"Tom",25
    [root@localhost bin]#

参数说明:  

  * -csv 指要要导出为 csv 格式
  * -f 指明需要导出哪些例

更详细的用法可以 mongoexport –help 来查看  

### 二、数据导入 mongoimport

在上例中我们讨论的是导出工具的使用，那么本节将讨论如何向表中导入数据  

#### 1、导入 JSON 数据

我们先将表 user 删除掉，以便演示效果  

    
    
    > db.user.drop();
    true
    > show collections;
    system.indexes
    >

然后导入数据  

    
    
    [root@localhost bin]# ./mongoimport -d my_mongodb -c user user.dat
    connected to: 127.0.0.1
    imported 2 objects
    [root@localhost bin]#

可以看到导入数据的时候会隐式创建表结构  

#### 2、导入 CSV 数据

我们先将表 user 删除掉，以便演示效果  

    
    
    > db.user.drop();
    true
    > show collections;
    system.indexes
    >

然后导入数据  

    
    
    [root@localhost bin]# ./mongoimport -d my_mongodb -c user --type csv --headerline --file user_csv.dat
    connected to: 127.0.0.1
    imported 3 objects
    [root@localhost bin]#

参数说明:  

  * -type 指明要导入的文件格式
  * -headerline 批明不导入第一行，因为第一行是列名
  * -file 指明要导入的文件路径

注意:  
CSV 格式良好，主流数据库都支持导出为 CSV 的格式，所以这种格式非常利于异构数据迁移  

  

