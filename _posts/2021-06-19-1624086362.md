---
title: Spring----JmsTemplate
categories: 
tags: java 测试
---
尽管消息接收可以使用消息监听的方式替代模板方法，但是发送的时候是无法代替的，在Spring中必须要使用JmsTemplate提供的方法来进行发送操作，可见JmsTemplate类的重要性，那么我们对于整合消息服务的分析就从JmsTemplate开始。

### JmsTemplate

在上一篇文章中，我们看到了Spring采用了与JDBC等一贯的套路，为我们提供了JmsTemplate来封装常用操作。下面看一下它的类图：

![](data:image/png;base64,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)

提取我们感兴趣的接口InitializingBean，接口方法的实现是在JmsAccessor类中，如下：

    
    
    public void afterPropertiesSet() {
            if (getConnectionFactory() == null) {
                throw new IllegalArgumentException("Property 'connectionFactory' is required");
            }
        }

发现函数中只是一个验证功能，并没有逻辑实现。所以丢掉这里，转向实例代码分析。首先以发送为例，在Spring中发送消息可以通过JmsTemplate中提供的方法来实现。

    
    
    public void send(final Destination destination, final MessageCreator messageCreator) throws JmsException {
            execute(session -> {
                doSend(session, destination, messageCreator);
                return null;
            }, false);
        }

这个函数的风格不得不让我们回想起JdbcTemplate的类实现风格，极为相似，都是提取一个公共的方法作为最底层、最通用的功能实现，然后又通过回调函数的不同来区分个性化的功能。

我们首先查看通用代码的抽取实现。

**1.通用代码抽取**

    
    
    public <T> T execute(SessionCallback<T> action, boolean startConnection) throws JmsException {
            Assert.notNull(action, "Callback object must not be null");
            Connection conToClose = null;
            Session sessionToClose = null;
            try {
                Session sessionToUse = ConnectionFactoryUtils.doGetTransactionalSession(
                        obtainConnectionFactory(), this.transactionalResourceFactory, startConnection);
                if (sessionToUse == null) {
                    //创建connection
                    conToClose = createConnection();
                    //创建session
                    sessionToClose = createSession(conToClose);
                    //是否开启向服务器推送连接信息，只有接收消息时需要，发送时不需要
                    if (startConnection) {
                        conToClose.start();
                    }
                    sessionToUse = sessionToClose;
                }
                if (logger.isDebugEnabled()) {
                    logger.debug("Executing callback on JMS Session: " + sessionToUse);
                }
                //调用回调函数
                return action.doInJms(sessionToUse);
            }
            catch (JMSException ex) {
                throw convertJmsAccessException(ex);
            }
            finally {
                //关闭session
                JmsUtils.closeSession(sessionToClose);
                //释放连接
                ConnectionFactoryUtils.releaseConnection(conToClose, getConnectionFactory(), startConnection);
            }
        }

上述代码封装了connection以及session的创建操作。在准备工作结束后，调用回调函数将程序引入用户自定义实现的个性化处理。

**2.发送消息的实现**

有了基类的辅助实现，使得Spring更加专注于个性的处理，也就是说Spring使用execute方法中封装了冗余代码，而将个性化的代码实现放在了回调函数doInJms中。在发送消息的功能中回调函数通过局部类实现。

    
    
    execute(session -> {
                doSend(session, destination, messageCreator);
                return null;
            }, false);

此时的发送逻辑已经完全转向了doSend方法，这样使整个功能实现变得更加清晰了。

    
    
    protected void doSend(Session session, Destination destination, MessageCreator messageCreator)
                throws JMSException {
    
            Assert.notNull(messageCreator, "MessageCreator must not be null");
            MessageProducer producer = createProducer(session, destination);
            try {
                Message message = messageCreator.createMessage(session);
                if (logger.isDebugEnabled()) {
                    logger.debug("Sending created message: " + message);
                }
                doSend(producer, message);
                // Check commit - avoid commit call within a JTA transaction.
                if (session.getTransacted() && isSessionLocallyTransacted(session)) {
                    // Transacted session created by this template -> commit.
                    JmsUtils.commitIfNecessary(session);
                }
            }
            finally {
                JmsUtils.closeMessageProducer(producer);
            }
        }

在发送消息还是遵循着消息发送的规则，比如根据Destination创建MessageProducer、创建Message，并使用MessageProducer实例来发送消息。

**3.接收消息**

我们通常使用JmsTemplate.receive(destination)来接收简单的消息，那么这个功能Spring是如何封装的呢？

    
    
    public Message receive(Destination destination) throws JmsException {
            return receiveSelected(destination, null);
        }
    
    
    public Message receiveSelected(final Destination destination, @Nullable final String messageSelector) throws JmsException {
            return execute(session -> doReceive(session, destination, messageSelector), true);
        }
    
    
    protected Message doReceive(Session session, Destination destination, @Nullable String messageSelector)
                throws JMSException {
    
            return doReceive(session, createConsumer(session, destination, messageSelector));
        }
    
    
    protected Message doReceive(Session session, MessageConsumer consumer) throws JMSException {
            try {
                // Use transaction timeout (if available).
                long timeout = getReceiveTimeout();
                ConnectionFactory connectionFactory = getConnectionFactory();
                JmsResourceHolder resourceHolder = null;
                if (connectionFactory != null) {
                    resourceHolder = (JmsResourceHolder) TransactionSynchronizationManager.getResource(connectionFactory);
                }
                if (resourceHolder != null && resourceHolder.hasTimeout()) {
                    timeout = Math.min(timeout, resourceHolder.getTimeToLiveInMillis());
                }
                Message message = receiveFromConsumer(consumer, timeout);
                if (session.getTransacted()) {
                    // Commit necessary - but avoid commit call within a JTA transaction.
                    if (isSessionLocallyTransacted(session)) {
                        // Transacted session created by this template -> commit.
                        JmsUtils.commitIfNecessary(session);
                    }
                }
                else if (isClientAcknowledge(session)) {
                    // Manually acknowledge message, if any.
                    if (message != null) {
                        message.acknowledge();
                    }
                }
                return message;
            }
            finally {
                JmsUtils.closeMessageConsumer(consumer);
            }
        }

实现的套路还是和发送差不多，同样还是使用execute函数来封装多余的操作，而最终的目的还是通过consumer.receive()来接收消息，其中的过程就是对于MessageConsumer的创建以及一些辅助操作。

参考：《Spring源码深度解析》 郝佳 编著：

转载于:https://www.cnblogs.com/Joe-Go/p/10314334.html

