---
title: Hive之——防止数据被误删除
categories: 精通大数据系列
tags: Hive
---
1、HDFS层面开启trash功能（fs.trash.interval)  
被删除的数据在HDFS中的/user/$USER/.Trash目录中，开启这个功能秩序要将配置属性fs.trash.interval得知你设置成为合理的整数，单位是分钟。设置值1440为24小时。如果删除了重要的数据，可以重新建一张表，重新建所需的分区，再从.Trash目录将误删除的文件移动到正确的文件夹目录下。

2、创建外部表，create external table tablename .......  
删除表时只删除元数据，不删除data数据  
  
3、控制不能使用drop table  
（1）alter table tabelname partition(year=2012,month=1,day=1) enable
no_drop;更改已经存在的表不能被删除  
（2）create table tablename ......
tblproperties('protect_mode'='no_drop');新建表不能被drop  
  
注：使用disable可以达到enable相反操作目的。  
  
4、防止数据被查询  
alter table tabelname partition(year=2012,month=1,day=1) enable offline;  
注：使用disable可以达到enable相反操作目的。

